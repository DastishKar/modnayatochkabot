import sqlite3
from datetime import datetime, timedelta
import random
import asyncio
from telegram import Update, ReplyKeyboardMarkup, InlineKeyboardMarkup, InlineKeyboardButton, BotCommand
from telegram.ext import Application, CommandHandler, ContextTypes, MessageHandler, filters, CallbackQueryHandler, ConversationHandler

# –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
main_keyboard = [
    ["–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ", "–ù–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞"], 
    ["–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å", "–ö–æ–º–∞–Ω–¥—ã"]
]

# –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
VOTE_QUESTION, VOTE_OPTIONS, REMINDER_TIME, REMINDER_MESSAGE = range(4)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
conn = sqlite3.connect("telegram_bot.db", check_same_thread=False)
cursor = conn.cursor()

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
cursor.execute("""
    CREATE TABLE IF NOT EXISTS users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER UNIQUE,
        username TEXT,
        first_name TEXT,
        joined_at TEXT
    )
""")

cursor.execute("""
    CREATE TABLE IF NOT EXISTS polls (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        question TEXT,
        options TEXT,
        created_at TEXT,
        created_by INTEGER,
        chat_id INTEGER
    )
""")

cursor.execute("""
    CREATE TABLE IF NOT EXISTS poll_votes (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        poll_id INTEGER,
        user_id INTEGER,
        option_index INTEGER,
        UNIQUE(poll_id, user_id)
    )
""")

cursor.execute("""
    CREATE TABLE IF NOT EXISTS reminders (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        chat_id INTEGER,
        user_id INTEGER,
        reminder_time TEXT,
        message TEXT,
        created_at TEXT
    )
""")

conn.commit()

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –≥–∞–¥–∞–Ω–∏—è
fortune_messages = [
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –±—É–¥–µ—à—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, —á—Ç–æ –≤—Å–µ –∏–¥–µ—Ç –∫–∞–∫ –Ω–∞–¥–æ, –Ω–æ –Ω–µ —Ä–∞—Å—Å–ª–∞–±–ª—è–π—Å—è.",
    "–¢—ã –æ–∫–∞–∂–µ—à—å—Å—è –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Å—Ç–∞–≤–∏—Ç —Ç–µ–±—è —É—Å–æ–º–Ω–∏—Ç—å—Å—è –≤ —Å–µ–±–µ, –Ω–æ —ç—Ç–æ –ª–∏—à—å –≤—Ä–µ–º–µ–Ω–Ω–æ.",
    "–¢–µ–±—è –∂–¥–µ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç –≤ –¥–µ–ª–∞—Ö, –Ω–æ —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è —Å —ç—Ç–∏–º.",
    "–°–µ–≥–æ–¥–Ω—è –∑–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤ –∏ –ø–æ–¥—É–º–∞—Ç—å –æ —Å–≤–æ–∏—Ö —Ü–µ–ª—è—Ö.",
    "–¢—ã –≤—Å—Ç—Ä–µ—Ç–∏—à—å –∫–æ–≥–æ-—Ç–æ, –∫—Ç–æ –∏–∑–º–µ–Ω–∏—Ç —Ç–≤–æ–∏ –≤–∑–≥–ª—è–¥—ã –Ω–∞ –∂–∏–∑–Ω—å, –Ω–æ –Ω–µ —Ç–æ—Ä–æ–ø–∏—Å—å —Å –≤—ã–≤–æ–¥–∞–º–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å —Å—Ç—Ä–∞—Ö–∏ –∏ –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–ø–µ—Ä–µ–¥.",
    "–¢—ã –ø–æ–π–º–µ—à—å, —á—Ç–æ —É—Å–ø–µ—Ö –∑–∞–≤–∏—Å–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç –¥–µ–π—Å—Ç–≤–∏–π, –Ω–æ –∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ—è.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –Ω–∞ –≤—ã—Å–æ—Ç–µ, —Ç–∞–∫ —á—Ç–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Å—è —ç—Ç–∏–º.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å —Ç–µ–º, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –≤–∞–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –Ω–æ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä.",
    "–¢—ã –ø–æ–ª—É—á–∏—à—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å –≤–∞–∂–Ω—ã–π —à–∞–≥, –Ω–æ –≤–∞–∂–Ω–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —Ä–µ—à–∏–º–æ—Å—Ç—å –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –ª—é–±—ã–µ –ø—Ä–µ–≥—Ä–∞–¥—ã.",
    "–¢—ã –æ–±–Ω–∞—Ä—É–∂–∏—à—å, —á—Ç–æ —Ç–æ, —á—Ç–æ –∫–∞–∑–∞–ª–æ—Å—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤–ø–æ–ª–Ω–µ –≤—ã–ø–æ–ª–Ω–∏–º–æ.",
    "–ó–≤–µ–∑–¥—ã —Å–æ–≤–µ—Ç—É—é—Ç —Ç–µ–±–µ —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –Ω–∞–∑–∞–¥ –∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–∏ —Ü–µ–ª–∏.",
    "–¢—ã —É–≤–∏–¥–∏—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤–æ–∏—Ö —É—Å–∏–ª–∏–π, –Ω–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ—è–≤–∏—Ç—å —Ç–µ—Ä–ø–µ–Ω–∏–µ.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –º–æ–∂–µ—à—å —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏, –Ω–æ –æ–Ω–∏ –±—É–¥—É—Ç –ø–æ–ª–µ–∑–Ω—ã–º–∏ –¥–ª—è —Ç–≤–æ–µ–≥–æ —Ä–æ—Å—Ç–∞.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –≤—Ä–µ–º—è –ø–µ—Ä–µ–º–µ–Ω, –Ω–æ –±—É–¥—å –≥–æ—Ç–æ–≤ –∫ —Ç–æ–º—É, —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –±—É–¥–µ—à—å –Ω–µ–º–Ω–æ–≥–æ —Å–±–∏—Ç —Å —Ç–æ–ª–∫—É, –Ω–æ –≤—Å–µ –≤—Å—Ç–∞–Ω–µ—Ç –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞.",
    "–¢—ã –Ω–∞–π–¥–µ—à—å —Ä–µ—à–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–∏, –µ—Å–ª–∏ –±—É–¥–µ—à—å –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–º.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –æ–∫–∞–∂–µ—à—å—Å—è –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –≥–¥–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç—å—Å—è –∏–Ω—Ç—É–∏—Ü–∏–∏.",
    "–¢—ã –æ–±–Ω–∞—Ä—É–∂–∏—à—å, —á—Ç–æ –º–Ω–æ–≥–æ–µ –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ —Ç—ã –∏—â–µ—à—å, —É–∂–µ —Ä—è–¥–æ–º.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –±—É–¥–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ, –∏ —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —Å–¥–µ–ª–∞—Ç—å –≤–∞–∂–Ω—ã–π —à–∞–≥.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å –ª—ë–≥–∫–æ–µ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ, –Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–º –∫ –¥–µ–π—Å—Ç–≤–∏—é.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —Ä–µ—à–∏–º–æ—Å—Ç—å –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é —Ç—ã –ø–æ—Å—Ç–∞–≤–∏–ª –¥–∞–≤–Ω–æ.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å –≤–æ–ø—Ä–æ—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –¥–æ–ª–≥–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª, –Ω–æ —Å–µ–≥–æ–¥–Ω—è —Ç—ã —Ä–µ—à–∏—à—å –µ–≥–æ —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞.",
    "–ó–≤–µ–∑–¥—ã —Å–æ–≤–µ—Ç—É—é—Ç –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö ‚Äî —Å–µ–≥–æ–¥–Ω—è —Ç—ã –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –¥–∞–≤–Ω–æ –Ω–∞—á–∞—Ç–æ–µ –¥–µ–ª–æ, –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–∏—à—å —É—Å–∏–ª–∏—è.",
    "–¢—ã –Ω–∞–π–¥–µ—à—å —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –µ—Å–ª–∏ –ø–æ–¥–æ–π–¥–µ—à—å –∫ –Ω–µ–π —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–µ–º-—Ç–æ, –∫—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–∏—Ç —Ç–µ–±—è –Ω–∞ –≤–∞–∂–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ—Ç–ø—É—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä–æ–µ –∏ –¥–≤–∏–≥–∞—Ç—å—Å—è –∫ –Ω–æ–≤–æ–º—É.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –±—É–¥–µ—à—å –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ, –Ω–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –ø–æ–¥—ä–µ–º ‚Äî —ç—Ç–æ –Ω–µ –∫–æ–Ω–µ—Ü –ø—É—Ç–∏.",
    "–¢–µ–±—è –∂–¥—ë—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —É—Å–ø–µ—Ö –≤ —Ç–æ–º, —á—Ç–æ —Ç—ã –Ω–µ –æ–∂–∏–¥–∞–ª –Ω–∞—á–∞—Ç—å.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–±—è –¥–∞–≤–Ω–æ –º—É—á–∏–ª.",
    "–¢—ã –±—É–¥–µ—à—å –æ–∫—Ä—É–∂—ë–Ω –ª—é–¥—å–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Ç–µ–±–µ —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–≤–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–≤–æ–π –ø—É—Ç—å –Ω–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ø—Ä—è–º—ã–º, –Ω–æ —Ç—ã —Å–º–æ–∂–µ—à—å –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –≤—Å–µ –ø–æ–≤–æ—Ä–æ—Ç—ã.",
    "–¢—ã –≤—Å—Ç—Ä–µ—Ç–∏—à—å –∫–æ–≥–æ-—Ç–æ, –∫—Ç–æ –æ—Ç–∫—Ä–æ–µ—Ç —Ç–µ–±–µ –Ω–æ–≤—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã –∏ –∏–¥–µ–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ—è–≤–∏—Ç—å —Ç–µ—Ä–ø–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.",
    "–¢—ã –±—É–¥–µ—à—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è —É–≤–µ—Ä–µ–Ω–Ω–æ, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ —É—Å–ø–µ—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å —É–ø–æ—Ä—Å—Ç–≤–æ–º.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –æ—Ç–∫—Ä–æ–µ—à—å –¥–ª—è —Å–µ–±—è —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ, —á—Ç–æ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç —Ç–≤–æ—é –∂–∏–∑–Ω—å.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –∏ –Ω–µ —É–ø—É—Å—Ç–∏—à—å —à–∞–Ω—Å.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–≤–æ–µ –±—É–¥—É—â–µ–µ, –Ω–æ —Ç—ã –∑–Ω–∞–µ—à—å, —á—Ç–æ –¥–µ–ª–∞—Ç—å.",
    "–¢—ã –æ–∫–∞–∂–µ—à—å—Å—è –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—Ç–µ, —Ç–∞–∫ —á—Ç–æ –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π, –µ—Å–ª–∏ –≤—Å—ë –∏–¥–µ—Ç –Ω–µ –ø–æ –ø–ª–∞–Ω—É.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–≤–æ—è —Ä–µ—à–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —É—Å–ø–µ—Ö—É, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—è–≤–∏—Ç—å –≥–∏–±–∫–æ—Å—Ç—å.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —É–≤–∏–¥–∏—à—å, –∫–∞–∫ —Ç–≤–æ–∏ —É—Å–∏–ª–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –ø–ª–æ–¥—ã.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å –≤–æ–ø—Ä–æ—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–≤–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –µ–≥–æ —Ä–µ—à–µ–Ω–∏—è.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –∏ —ç–Ω—Ç—É–∑–∏–∞–∑–º –ø–æ–º–æ–≥—É—Ç —Ç–µ–±–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –∫ –∫–æ—Ç–æ—Ä–æ–º—É —Ç—ã –¥–∞–≤–Ω–æ —Å—Ç—Ä–µ–º–∏–ª—Å—è.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –≤—Å—ë —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞, –µ—Å–ª–∏ –±—É–¥–µ—à—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ.",
    "–¢–µ–±—è –∂–¥—ë—Ç –≤—Å—Ç—Ä–µ—á–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–≤–µ—Ä–Ω—ë—Ç —Ç–≤–æ–∏ –≤–∑–≥–ª—è–¥—ã –Ω–∞ –≤–µ—â–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –ø–æ–ª—É—á–∏—à—å –Ω–æ–≤–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Å—Ç–∞–≤—è—Ç —Ç–µ–±—è –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–∏ —Ü–µ–ª–∏.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω—ë—à—å—Å—è —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –≤—ã–∑–æ–≤–æ–º, –Ω–æ —Å–º–æ–∂–µ—à—å —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –Ω–∏–º –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–º—É –æ–ø—ã—Ç—É.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–∏ –º—ã—Å–ª–∏ –±—É–¥—É—Ç —è—Å–Ω—ã–º–∏, –∏ —Ç—ã —Å–º–æ–∂–µ—à—å –ø—Ä–∏–Ω—è—Ç—å –≤–∞–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–≤–æ–∏—Ö —Å–∏–ª–∞—Ö, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –≤–∞–∂–Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–º.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —É–¥–∞—á–∞ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–µ—à–µ–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å.",
    "–¢—ã –≤—Å—Ç—Ä–µ—Ç–∏—à—å —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–µ—Ç –¥–ª—è —Ç–µ–±—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –≤–∞–∂–Ω—ã–π —à–∞–≥ –≤–ø–µ—Ä–µ–¥, –Ω–æ –Ω–µ —Ç–æ—Ä–æ–ø–∏—Å—å.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–∏ —É—Å–∏–ª–∏—è –ø—Ä–∏–Ω–µ—Å—É—Ç –¥–æ–ª–≥–æ–∂–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω—ë—à—å—Å—è —Å —Å–∏—Ç—É–∞—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ—Ç —Ç–µ–±—è –≥–∏–±–∫–æ—Å—Ç–∏, –Ω–æ —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –ø–æ–¥—Å–∫–∞–∂–µ—Ç —Ç–µ–±–µ, –∫–∞–∫ –ø–æ—Å—Ç—É–ø–∏—Ç—å –≤ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.",
    "–¢—ã –±—É–¥–µ—à—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, —á—Ç–æ —Ç–≤–æ–∏ —É—Å–∏–ª–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–≤–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –º–æ–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω, –∏ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤ –∏—Ö –ø—Ä–∏–Ω—è—Ç—å.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–æ–≤—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–∞–≤–Ω–æ —Ç–µ–±—è –±–µ—Å–ø–æ–∫–æ–∏–ª–∞.",
    "–¢—ã –±—É–¥–µ—à—å –æ–∫—Ä—É–∂—ë–Ω –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏, –Ω–æ –≤–∞–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —É—Å–ø–µ—Ö—É.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä, –Ω–æ —Ç—ã —É–∂–µ –∑–Ω–∞–µ—à—å, —á—Ç–æ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –≤—Å—ë, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ, —É–∂–µ –µ—Å—Ç—å —Ä—è–¥–æ–º, –Ω—É–∂–Ω–æ –ª–∏—à—å —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –≤–ø–µ—Ä–µ–¥.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–∏ —É—Å–∏–ª–∏—è –ø—Ä–∏–≤–µ–¥—É—Ç –∫ —É—Å–ø–µ—Ö—É, –µ—Å–ª–∏ —Ç—ã –±—É–¥–µ—à—å –≤–µ—Ä–∏—Ç—å –≤ —Å–µ–±—è.",
    "–¢—ã –≤—Å—Ç—Ä–µ—Ç–∏—à—å –∫–æ–≥–æ-—Ç–æ, –∫—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –Ω–∞ –ø—É—Ç–∏ –∫ —Ç–≤–æ–∏–º —Ü–µ–ª—è–º.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –∫–∞–∑–∞–ª–∞—Å—å –Ω–µ—Ä–µ—à–∞–µ–º–æ–π.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –≤–∞–∂–Ω–æ–º –≤–æ–ø—Ä–æ—Å–µ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ —Ç–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–∫–æ–Ω–µ—Ü –Ω–∞—á–∏–Ω–∞—é—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å –∑–∞–¥–∞—á–µ–π, –∫–æ—Ç–æ—Ä—É—é —Ä–∞–Ω—å—à–µ —Å—á–∏—Ç–∞–ª –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π, –Ω–æ —Ç–µ–ø–µ—Ä—å —Å–º–æ–∂–µ—à—å –µ—ë —Ä–µ—à–∏—Ç—å.",
    "–¢—ã –æ–±–Ω–∞—Ä—É–∂–∏—à—å, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±—è –±–µ—Å–ø–æ–∫–æ–∏–ª–∏, —É–∂–µ –¥–∞–≤–Ω–æ —É —Ç–µ–±—è –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —É—Å–ø–µ—Ö—É –≤ —Ç–æ–º, —á—Ç–æ —Ç—ã –¥–∞–≤–Ω–æ —Ö–æ—Ç–µ–ª –¥–æ—Å—Ç–∏—á—å.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ –≤—Å–µ –≤–æ–∫—Ä—É–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è –≤ —Ç–≤–æ—é –ø–æ–ª—å–∑—É, –µ—Å–ª–∏ –±—É–¥–µ—à—å –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å —à–∞–Ω—Å —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –≤–ø–µ—Ä–µ–¥ –≤ —Å–≤–æ–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º –ø—É—Ç–∏.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —Ä–µ—à–∏–º–æ—Å—Ç—å –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –ª—é–±—ã–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –Ω–∞ –ø—É—Ç–∏ –∫ —Ü–µ–ª–∏.",
    "–¢—ã –±—É–¥–µ—à—å –æ–∫—Ä—É–∂—ë–Ω –ª—é–¥—å–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Ç–µ–±–µ —Å–¥–µ–ª–∞—Ç—å –≤–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —Å–¥–µ–ª–∞—Ç—å –≤–∞–∂–Ω—ã–π —à–∞–≥.",
    "–¢—ã –ø–æ–ª—É—á–∏—à—å —à–∞–Ω—Å –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å, –Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –µ–≥–æ –≤–æ–≤—Ä–µ–º—è.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å —Å–∏—Ç—É–∞—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ—Ç —Ç–µ–±—è —Ö—Ä–∞–±—Ä–æ—Å—Ç–∏, –Ω–æ —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –ª—é–±—ã–º–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏.",
    "–¢—ã –±—É–¥–µ—à—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, —á—Ç–æ –Ω–∞ —Ç–≤–æ–µ–º –ø—É—Ç–∏ –µ—Å—Ç—å –ø–æ–º–æ—â—å, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ –±—É–¥–µ—Ç –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –≤–∞–∂–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∏ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ –æ—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–≥–æ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ —Ç–≤–æ—è –∂–∏–∑–Ω—å –Ω–∞—á–∏–Ω–∞–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É.",
    "–ó–≤–µ–∑–¥—ã –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ç–≤–æ—è —É–ø–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞—á–Ω—ë—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –¥–æ–ª–≥–æ–∂–¥–∞–Ω–Ω—ã–µ –ø–ª–æ–¥—ã.",
    "–°–µ–≥–æ–¥–Ω—è —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å—Ç–∞—Ä—É—é –∑–∞–¥–∞—á—É –∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.",
    "–¢—ã —Å—Ç–æ–ª–∫–Ω–µ—à—å—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π, –Ω–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–≤–æ–∏—Ö —Å–∏–ª, –∏ —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è.",
    "–°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–∏ —É—Å–∏–ª–∏—è –±—É–¥—É—Ç –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω—ã, –Ω–æ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–µ—Ä–ø–µ–Ω–∏–µ.",
    "–¢—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å, —á—Ç–æ —Ç–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∏ —ç—Ç–æ —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–∏—Ç."
]

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.effective_user
    chat_type = update.message.chat.type
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É, –µ—Å–ª–∏ –µ–≥–æ —Ç–∞–º –Ω–µ—Ç
    cursor.execute("""
        INSERT OR IGNORE INTO users (user_id, username, first_name, joined_at)
        VALUES (?, ?, ?, ?)
    """, (user.id, user.username, user.first_name, now))
    conn.commit()
    
    if chat_type in ["group", "supergroup"]:
        await update.message.reply_text(f"–ü—Ä–∏–≤–µ—Ç, {user.first_name}! üëã –Ø —Ç–µ–ø–µ—Ä—å –≤ –≤–∞—à–µ–π –≥—Ä—É–ø–ø–µ!")
    else:
        await update.message.reply_text(
            f"–ü—Ä–∏–≤–µ—Ç, {user.first_name}! üëã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:",
            reply_markup=ReplyKeyboardMarkup(main_keyboard, resize_keyboard=True)
        )
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
async def add_user(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.effective_user
    user_id = user.id
    first_name = user.first_name
    joined_at = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤ –±–∞–∑–µ
    cursor.execute("SELECT user_id FROM users WHERE user_id = ?", (user_id,))
    existing_user = cursor.fetchone()
    
    if not existing_user:
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        cursor.execute(
            "INSERT INTO users (user_id, first_name, joined_at) VALUES (?, ?, ?)",
            (user_id, first_name, joined_at)
        )
        conn.commit()
        await update.message.reply_text(f"–ü—Ä–∏–≤–µ—Ç, {first_name}! –¢—ã –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π.")
    else:
        await update.message.reply_text(f"{first_name}, —Ç—ã —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ –¥—Ä—É–∑–µ–π!")


# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π
async def show_friends(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â–µ–≥–æ
    cursor.execute("SELECT first_name, joined_at FROM users")
    rows = cursor.fetchall()
    
    if not rows:
        await update.message.reply_text("–í —Å–ø–∏—Å–∫–µ –¥—Ä—É–∑–µ–π –ø–æ–∫–∞ –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç üò¢")
    else:
        message = "üë• –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π:\n\n"
        for row in rows:
            first_name = row[0]
            joined_at = row[1]
            
            message += f"‚Ä¢ {first_name} (–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è: {joined_at})\n"
            
        await update.message.reply_text(message)

# –§—É–Ω–∫—Ü–∏—è –≥–∞–¥–∞–Ω–∏—è –Ω–∞ –¥–µ–Ω—å
async def daily_fortune(update: Update, context: ContextTypes.DEFAULT_TYPE):
    fortune = random.choice(fortune_messages)
    await update.message.reply_text(f"üîÆ –ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:\n\n{fortune}")

# –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
async def start_voting(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üìä –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è\n\n–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, '–ö—É–¥–∞ –ø–æ–π–¥—ë–º?' –∏–ª–∏ '–ß—Ç–æ —Å–º–æ—Ç—Ä–∏–º?'):"
    )
    return VOTE_QUESTION

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
async def get_vote_question(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data['vote_question'] = update.message.text
    await update.message.reply_text(
        "–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤, —Ä–∞–∑–¥–µ–ª—è—è –∏—Ö –∑–∞–ø—è—Ç—ã–º–∏.\n–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∏–Ω–æ, –ë–æ—É–ª–∏–Ω–≥, –ö–∞—Ñ–µ"
    )
    return VOTE_OPTIONS

# –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
async def create_vote(update: Update, context: ContextTypes.DEFAULT_TYPE):
    options_text = update.message.text
    options = [opt.strip() for opt in options_text.split(',')]
    
    if len(options) < 2:
        await update.message.reply_text("–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑:")
        return VOTE_OPTIONS
    
    question = context.user_data['vote_question']
    user_id = update.effective_user.id
    chat_id = update.effective_chat.id
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("""
        INSERT INTO polls (question, options, created_at, created_by, chat_id)
        VALUES (?, ?, ?, ?, ?)
    """, (question, options_text, now, user_id, chat_id))
    conn.commit()
    poll_id = cursor.lastrowid
    
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
    keyboard = []
    for i, option in enumerate(options):
        keyboard.append([InlineKeyboardButton(option, callback_data=f"vote_{poll_id}_{i}")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await update.message.reply_text(
        f"üìä –ì–û–õ–û–°–û–í–ê–ù–ò–ï:\n\n{question}",
        reply_markup=reply_markup
    )
    
    return ConversationHandler.END

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤
async def handle_vote(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    
    data_parts = query.data.split('_')
    poll_id = int(data_parts[1])
    option_index = int(data_parts[2])
    user_id = query.from_user.id
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –≥–æ–ª–æ—Å
    try:
        cursor.execute("""
            INSERT INTO poll_votes (poll_id, user_id, option_index)
            VALUES (?, ?, ?)
        """, (poll_id, user_id, option_index))
        conn.commit()
    except sqlite3.IntegrityError:
        cursor.execute("""
            UPDATE poll_votes
            SET option_index = ?
            WHERE poll_id = ? AND user_id = ?
        """, (option_index, poll_id, user_id))
        conn.commit()
    
    # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏
    cursor.execute("SELECT question, options FROM polls WHERE id = ?", (poll_id,))
    poll_data = cursor.fetchone()
    question = poll_data[0]
    options = [opt.strip() for opt in poll_data[1].split(',')]
    
    # –°—á–∏—Ç–∞–µ–º –≥–æ–ª–æ—Å–∞
    cursor.execute("""
        SELECT option_index, COUNT(*) as votes
        FROM poll_votes
        WHERE poll_id = ?
        GROUP BY option_index
    """, (poll_id,))
    vote_counts = {row[0]: row[1] for row in cursor.fetchall()}
    
    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    result_text = f"üìä –ì–û–õ–û–°–û–í–ê–ù–ò–ï:\n\n{question}\n\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:\n"
    for i, option in enumerate(options):
        votes = vote_counts.get(i, 0)
        result_text += f"\n{option}: {votes} –≥–æ–ª–æ—Å(–æ–≤)"
    
    # –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
    keyboard = []
    for i, option in enumerate(options):
        keyboard.append([InlineKeyboardButton(option, callback_data=f"vote_{poll_id}_{i}")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=result_text,
        reply_markup=reply_markup
    )

# –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
async def start_reminder(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üîî –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è\n\n–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ß–ß:–ú–ú –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, '30–º'):"
    )
    return REMINDER_TIME

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
async def get_reminder_time(update: Update, context: ContextTypes.DEFAULT_TYPE):
    time_text = update.message.text.strip()
    now = datetime.now()
    
    try:
        if '–º' in time_text:
            # –§–æ—Ä–º–∞—Ç –≤ –º–∏–Ω—É—Ç–∞—Ö
            minutes = int(time_text.replace('–º', ''))
            reminder_time = now + timedelta(minutes=minutes)
        else:
            # –§–æ—Ä–º–∞—Ç –ß–ß:–ú–ú
            hour, minute = map(int, time_text.split(':'))
            reminder_time = now.replace(hour=hour, minute=minute)
            
            # –ï—Å–ª–∏ –≤—Ä–µ–º—è —É–∂–µ –ø—Ä–æ—à–ª–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞ –∑–∞–≤—Ç—Ä–∞
            if reminder_time < now:
                reminder_time += timedelta(days=1)
    except:
        await update.message.reply_text("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 18:00 –∏–ª–∏ 30–º):")
        return REMINDER_TIME
    
    context.user_data['reminder_time'] = reminder_time
    
    await update.message.reply_text("–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:")
    return REMINDER_MESSAGE

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
async def create_reminder(update: Update, context: ContextTypes.DEFAULT_TYPE):
    reminder_message = update.message.text
    reminder_time = context.user_data['reminder_time']
    user_id = update.effective_user.id
    chat_id = update.effective_chat.id
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("""
        INSERT INTO reminders (chat_id, user_id, reminder_time, message, created_at)
        VALUES (?, ?, ?, ?, ?)
    """, (chat_id, user_id, reminder_time.strftime("%Y-%m-%d %H:%M:%S"), reminder_message, now))
    conn.commit()
    
    # –ü–ª–∞–Ω–∏—Ä—É–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
    time_diff = (reminder_time - datetime.now()).total_seconds()
    
    if time_diff > 0:
        context.job_queue.run_once(
            send_reminder,
            time_diff,
            chat_id=chat_id,
            data={'message': reminder_message, 'reminder_id': cursor.lastrowid}
        )
    
    await update.message.reply_text(
        f"‚úÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ {reminder_time.strftime('%H:%M')}:\n{reminder_message}"
    )
    
    return ConversationHandler.END

# –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
async def send_reminder(context: ContextTypes.DEFAULT_TYPE):
    job = context.job
    reminder_data = job.data
    reminder_message = reminder_data['message']
    reminder_id = reminder_data['reminder_id']
    
    await context.bot.send_message(
        job.chat_id,
        f"üîî –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï:\n\n{reminder_message}"
    )
    
    # –£–¥–∞–ª—è–µ–º –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("DELETE FROM reminders WHERE id = ?", (reminder_id,))
    conn.commit()

# –ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
async def load_reminders(application):
    now = datetime.now()
    
    cursor.execute("SELECT id, chat_id, reminder_time, message FROM reminders")
    reminders = cursor.fetchall()
    
    for reminder in reminders:
        reminder_id, chat_id, reminder_time_str, message = reminder
        reminder_time = datetime.strptime(reminder_time_str, "%Y-%m-%d %H:%M:%S")
        
        # –ü–ª–∞–Ω–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –±—É–¥—É—â–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        time_diff = (reminder_time - now).total_seconds()
        if time_diff > 0:
            application.job_queue.run_once(
                send_reminder,
                time_diff,
                chat_id=chat_id,
                data={'message': message, 'reminder_id': reminder_id}
            )

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
async def show_commands(update: Update, context: ContextTypes.DEFAULT_TYPE):
    commands_text = """
üìã *–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:*

*–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*
/start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
/menu - –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/commands - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

*–§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞:*
/vote - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
/reminder - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
/fortune - –ü–æ–ª—É—á–∏—Ç—å –≥–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å
/friend - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π

*–ö–Ω–æ–ø–∫–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ:*
‚Ä¢ –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ - –°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å
‚Ä¢ –ù–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞ - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
‚Ä¢ –ì–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å - –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
‚Ä¢ –ö–æ–º–∞–Ω–¥—ã - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫
    """
    
    await update.message.reply_text(
        commands_text,
        parse_mode="Markdown"
    )

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
async def handle_text(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text.lower()
    
    if "–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ" in text:
        return await start_voting(update, context)
    elif "–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞" in text:
        return await start_reminder(update, context)
    elif "–≥–∞–¥–∞–Ω–∏–µ" in text:
        await daily_fortune(update, context)
    elif "–¥—Ä—É–∑—å—è" in text:
        await show_friends(update, context)
    elif "–∫–æ–º–∞–Ω–¥—ã" in text:
        await show_commands(update, context)

# –û—Ç–º–µ–Ω–∞ –¥–∏–∞–ª–æ–≥–∞
async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞.",
        reply_markup=ReplyKeyboardMarkup(main_keyboard, resize_keyboard=True)
    )
    return ConversationHandler.END

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ –≤ –º–µ–Ω—é Telegram
async def setup_commands(application):
    commands = [
        BotCommand("start", "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞"),
        BotCommand("menu", "–ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"),
        BotCommand("vote", "–°–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ"),
        BotCommand("reminder", "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ"),
        BotCommand("fortune", "–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å"),
        BotCommand("friend", "–°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π"),
        BotCommand("commands", "–°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥")
    ]
    
    await application.bot.set_my_commands(commands)

async def post_init(application: Application):
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
    await load_reminders(application)
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã –≤ –º–µ–Ω—é
    await setup_commands(application)

def main():
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á
    app = Application.builder().token("7599952186:AAG3e72f5Glf5dN15YQcubtx0dkXJev3kmM").post_init(post_init).build()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–∏–∞–ª–æ–≥–æ–≤
    vote_conv_handler = ConversationHandler(
        entry_points=[CommandHandler("vote", start_voting),
                     MessageHandler(filters.Regex(r"(?i)–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ"), start_voting)],
        states={
            VOTE_QUESTION: [MessageHandler(filters.TEXT & ~filters.COMMAND, get_vote_question)],
            VOTE_OPTIONS: [MessageHandler(filters.TEXT & ~filters.COMMAND, create_vote)]
        },
        fallbacks=[CommandHandler("cancel", cancel)]
    )
    
    reminder_conv_handler = ConversationHandler(
        entry_points=[CommandHandler("reminder", start_reminder),
                     MessageHandler(filters.Regex(r"(?i)–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞"), start_reminder)],
        states={
            REMINDER_TIME: [MessageHandler(filters.TEXT & ~filters.COMMAND, get_reminder_time)],
            REMINDER_MESSAGE: [MessageHandler(filters.TEXT & ~filters.COMMAND, create_reminder)]
        },
        fallbacks=[CommandHandler("cancel", cancel)]
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("menu", start))
    app.add_handler(CommandHandler("friend", show_friends))
    app.add_handler(CommandHandler("fortune", daily_fortune))
    app.add_handler(CommandHandler("commands", show_commands))
    # –í –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ–±–∞–≤—å—Ç–µ:
    app.add_handler(CommandHandler("join", add_user))
    app.add_handler(vote_conv_handler)
    app.add_handler(reminder_conv_handler)
    app.add_handler(CallbackQueryHandler(handle_vote, pattern="^vote_"))
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_text))
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω! –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.")
    app.run_polling()

if __name__ == "__main__":
    main()